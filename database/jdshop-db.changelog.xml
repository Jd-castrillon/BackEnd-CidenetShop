<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xmlns:pro="http://www.liquibase.org/xml/ns/pro"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">



	<changeSet author="jdkastrillon@gmail.com" id="1640030044-8">
		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="roles_id_sequence" startValue="1" />

		<createTable tableName="roles">
			<column name="id" type="BIGINT">
				<constraints nullable="false" primaryKey="true"
					primaryKeyName="pk_roles" />
			</column>
			<column name="role" type="VARCHAR">
				<constraints nullable="false" />
			</column>
		</createTable>

		<createTable tableName="document_types">
			<column name="id" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="role" type="VARCHAR">
				<constraints nullable="false" />
			</column>
		</createTable>

		<createTable tableName="users">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="document_number" type="VARCHAR">
				<constraints nullable="false" />
			</column>
			<column name="name" type="VARCHAR">
				<constraints nullable="false" />
			</column>
			<column name="email" type="VARCHAR">
				<constraints nullable="false" />
			</column>
			<column name="password" type="VARCHAR">
				<constraints nullable="false" />
			</column>

			<column name="document_type_id" type="BIGINT"></column>

			<column name="roles_id" type="BIGINT"></column>
		</createTable>



	</changeSet>

	<changeSet id="1640030044-9" author="jdkastrillon@gmail.com">
		<addForeignKeyConstraint
			constraintName="fk_document_type"
			referencedTableName="document_types"
			baseColumnNames="document_type_id" baseTableName="users"
			referencedColumnNames="id" />
	</changeSet>

	<changeSet id="1640044256870-1"
		author="jdkastrillon@gmail.com">
		<createTable tableName="sizes">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="size" type="VARCHAR">
				<constraints nullable="false" />
			</column>
		</createTable>

		<createTable tableName="genders">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="gender" type="VARCHAR(15)"></column>
		</createTable>

		<createTable tableName="products">

			<column name="id" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="name" type="VARCHAR(150)">
				<constraints nullable="false" />
			</column>
			<column name="color" type="VARCHAR(100)">
				<constraints nullable="false" />
			</column>
			<column name="brand" type="VARCHAR(100)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR">
				<constraints nullable="false" />
			</column>
			<column name="price" type="DOUBLE">
				<constraints nullable="false" />
			</column>
			<column name="id_gender" type="INT"></column>
		</createTable>

		<addForeignKeyConstraint
			constraintName="fk_gender" referencedTableName="genders"
			baseColumnNames="id_gender" baseTableName="products"
			referencedColumnNames="id" />

	</changeSet>

	<changeSet id="1640098062099-1"
		author="jdkastrillon@gmail.com">
		<createTable tableName="users_roles">
			<column name="id_user" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="id_role" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
		</createTable>

		<addForeignKeyConstraint
			constraintName="pk_user" referencedTableName="users"
			baseColumnNames="id_user" baseTableName="users_roles"
			referencedColumnNames="id" />
		<addForeignKeyConstraint
			constraintName="pk_roles" referencedTableName="roles"
			baseColumnNames="id_role" baseTableName="users_roles"
			referencedColumnNames="id" />

	</changeSet>

	<changeSet id="1640098062099-2"
		author="jdkastrillon@gmail.com">
		<createTable tableName="existing_quantity">
			<column name="id_product" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="id_size" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="existing_quantity" type="INT">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint
			constraintName="pk_product" referencedTableName="products"
			baseColumnNames="id_product" baseTableName="existing_quantity"
			referencedColumnNames="id" />
		<addForeignKeyConstraint
			constraintName="pk_sizes" referencedTableName="sizes"
			baseColumnNames="id_size" baseTableName="existing_quantity"
			referencedColumnNames="id" />

	</changeSet>

	<changeSet id="1640186318533-1"
		author="jdkastrillon@gmail.com">

		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="orders_id_sequence" startValue="1" />

		<createTable tableName="orders">
			<column name="id" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="order_address" type="VARCHAR(100)">
				<constraints nullable="false" />
			</column>
			<column name="order_date" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="total_cost" type="DOUBLE">
				<constraints nullable="false" />
			</column>

			<column name="id_user" type="BIGINT"></column>


		</createTable>

		<addForeignKeyConstraint
			constraintName="fk_user" referencedTableName="users"
			baseColumnNames="id_user" baseTableName="orders"
			referencedColumnNames="id" />

	</changeSet>

	<changeSet id="1640186318533-2"
		author="jdkastrillon@gmail.com">
		<createTable tableName="pictures">
			<column name="id_product" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="picture" type="BLOB">
			</column>
		</createTable>
		<addForeignKeyConstraint
			constraintName="fk_product" referencedTableName="products"
			baseColumnNames="id_product" baseTableName="pictures"
			referencedColumnNames="id" />

		<createTable tableName="order_details">
			<column name="id_order" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="id_product" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="sale_price" type="DOUBLE">
				<constraints nullable="false" />
			</column>
			<column name="quantity" type="INT">
				<constraints nullable="false" />
			</column>
			<column name="size" type="VARCHAR(10)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint
			constraintName="fk_order" referencedTableName="orders"
			baseColumnNames="id_order" baseTableName="order_details"
			referencedColumnNames="id" />
		<addForeignKeyConstraint
			constraintName="fk_products" referencedTableName="products"
			baseColumnNames="id_product" baseTableName="order_details"
			referencedColumnNames="id" />


	</changeSet>

	<changeSet id="1640186318533-3"
		author="jdkastrillon@gmail.com">
		<renameColumn tableName="document_types"
			oldColumnName="role" newColumnName="document_type" />
	</changeSet>

	<changeSet id="1640186318533-4"
		author="jdkastrillon@gmail.com">

		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="document_types_id_sequence" startValue="1" />
		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="users_id_sequence" startValue="1" />
		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="genders_id_sequence" startValue="1" />
		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="products_id_sequence" startValue="1" />
		<createSequence cacheSize="1" cycle="false"
			dataType="bigint" incrementBy="1" maxValue="9223372036854775807"
			minValue="1" sequenceName="sizes_id_sequence" startValue="1" />

	</changeSet>

	<changeSet id="1641944783112-1"
		author="jdkastrillon@gmail.com">
		<dropColumn tableName="users">
			<column name="roles_id"></column>
		</dropColumn>
	</changeSet>

	<changeSet author="jdkastrillon@gmail.com"
		id="1641944783112-2">
		<insert tableName="roles">
			<column name="id" valueSequenceNext="roles_id_sequence" />
			<column name="role" value="admin" />
		</insert>
		<insert tableName="roles">
			<column name="id" valueSequenceNext="roles_id_sequence" />
			<column name="role" value="client" />
		</insert>
	</changeSet>

	<changeSet id="1641944783112-3"
		author="jdkastrillon@gmail.com">
		<insert tableName="document_types">
			<column name="id"
				valueSequenceNext="document_types_id_sequence"></column>
			<column name="document_type" value="cedula de ciudadania"></column>
		</insert>
		<insert tableName="document_types">
			<column name="id"
				valueSequenceNext="document_types_id_sequence"></column>
			<column name="document_type" value="tarjeta de identidad"></column>
		</insert>
	</changeSet>
	<changeSet id="1641944783112-4"
		author="jdkastrillon@gmail.com">
		<insert tableName="sizes">
			<column name="id" valueSequenceNext="sizes_id_sequence"></column>
			<column name="size" value="XS"></column>
		</insert>
		<insert tableName="sizes">
			<column name="id" valueSequenceNext="sizes_id_sequence"></column>
			<column name="size" value="S"></column>
		</insert>
		<insert tableName="sizes">
			<column name="id" valueSequenceNext="sizes_id_sequence"></column>
			<column name="size" value="M"></column>
		</insert>
		<insert tableName="sizes">
			<column name="id" valueSequenceNext="sizes_id_sequence"></column>
			<column name="size" value="L"></column>
		</insert>
		<insert tableName="sizes">
			<column name="id" valueSequenceNext="sizes_id_sequence"></column>
			<column name="size" value="XL"></column>
		</insert>

		<insert tableName="genders">
			<column name="id" valueSequenceNext="genders_id_sequence"></column>
			<column name="gender" value="masculino"></column>
		</insert>
		<insert tableName="genders">
			<column name="id" valueSequenceNext="genders_id_sequence"></column>
			<column name="gender" value="femenino"></column>
		</insert>

	</changeSet>
	
	


</databaseChangeLog>